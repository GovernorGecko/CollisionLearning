<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>Collision Learning</title>
    <script src="js/AABB.js"></script>
    <script src="js/Square.js"></script>
    <script src="js/Vector2.js"></script>    
    <script>

        /*

            Simple Collision Learning in Javascript

        */        

        // To Test Collision With
        const squares = [
            new Square(new Vector2(70.0, 20.0), 30, 30, 1, false),
            new Square(new Vector2(70.0, 70.0), 40, 30, 1, true),           
        ]

        // Main Entry
        const collisionLearning = () => {
        
            const canvas = document.getElementById('canvas');
            const context = canvas.getContext('2d');
            
            const step = 1 / 60;
        
            const engine = msLastFrame => {

              //console.log(timestamp);

              // Clear our Canvas
              context.clearRect(0, 0, canvas.width, canvas.height);

              // Iterate our Squares
              for(let square of squares) {

                // COMPUTE EXTERNAL FORCES

                // Gravitational Force = mass * -9.81
                let gravitationalForce = new Vector2(0.0, square.Mass * -9.81);

                // acceleration = force / mass
                let acceleration = gravitationalForce / square.Mass;

                // APPLY FORCES

                // velocity = acceleration * dt
                square.UpdateLinearVelocity(acceleration * this.WorldStep);

                // position = veloctity * dt
                square.UpdatePosition(this.WorldStep);

                // Render
                square.Draw(context);

              }

              // Keep that engine stepping!
              window.requestAnimationFrame(engine);
            
            }

            // Start the Engine
            engine();

        }
        
    </script>
    <style>
      canvas { border: 1px solid black; }
    </style>
  </head>
  <body onload="collisionLearning();">
    <canvas id="canvas" width="150" height="150"></canvas>
  </body>
</html>